<odoo>
    <data>
        <!-- Help text for swapping among underpopulated shifts -->
        <template
            id="help_text_swap_underpopulated_common"
            name="Help Text Swap Underpopulated Common"
        >
            <div class="alert alert-info">
                <strong>Info!</strong>
                The shift that you want to swap is close in time.
                To accelerate the process, we suggest you subscribe to an
                underpopulated shift so that you don't need to wait for another
                cooperator. However, if none of the shifts presented here suits
                you, you can click on the button at the bottom of the page.
            </div>
        </template>

        <!-- Help text for swapping among all shifts -->
        <template id="help_text_swap_all" name="Help text swap all">
            <div class="alert alert-info">
                <strong>Info!</strong>
                The shift that you want to swap is close in time.
                To accelerate the process, we suggest you subscribe directly to
                a shift so that you don't need to wait for another cooperator.
            </div>
        </template>

        <!-- Template display shifts to swap -->
        <template id="website_shift_swap_next_tmpl_dated" name="Next shifts to swap">
            <h2 t-if="not all_shifts">
                Swap your shift with an underpopulated one
            </h2>
            <h2 t-else="">
                Swap your shift with another one
            </h2>
            <t t-foreach="displayed_shifts" t-as="tmpl_dated">
                <div t-att-class="'card mb-4 %s' % highlight_class">
                    <div
                        t-att-class="'card-header %s clearfix' % highlight_header_class"
                    >
                        <div class="pull-left">
                            <p>
                                <t t-esc="tmpl_dated.date.strftime('%A %d %b, %Y')" />
                                <t t-esc="'|'" />
                                <t
                                    t-esc="str(datetime.timedelta(hours=tmpl_dated.template_id.start_time)).rsplit(':', 1)[0]"
                                />
                                -
                                <t
                                    t-esc="str(datetime.timedelta(hours=tmpl_dated.template_id.end_time)).rsplit(':', 1)[0]"
                                />
                                <br />
                                <t t-esc="tmpl_dated.template_id.task_type_id.name" />
                            </p>
                        </div>
                    </div>
                    <div>
                        <div class="card-body clearfix">
                            <t
                                t-if="tmpl_dated.template_id.task_type_id != exchanged_tmpl_dated.template_id.task_type_id"
                            >
                                <button
                                    type="button"
                                    class="btn btn-success btn-sm"
                                    data-toggle="modal"
                                    t-att-data-target="'#warning-task-type-popup-%s' % tmpl_dated_index"
                                >
                                    Subscribe to this Shift
                                </button>
                            </t>
                            <t t-else="">
                                <a
                                    class="btn btn-success btn-sm"
                                    t-att-href="'/my/shift/swap/subscribe/%i/%s' % (tmpl_dated.template_id,tmpl_dated.date)"
                                >Subscribe to this Shift</a>
                            </t>
                        </div>
                    </div>
                </div>
                <!-- Modal popup to warn user if task type is different in the new shift -->
                <div
                    class="modal fade"
                    t-att-id="'warning-task-type-popup-%s' % tmpl_dated_index"
                    data-backdrop="static"
                    data-keyboard="false"
                    tabindex="-1"
                    aria-labelledby="warning-task-type-popup-label"
                    aria-hidden="true"
                >
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5
                                    class="modal-title"
                                    id="warning-task-type-popup-label"
                                >Warning !</h5>
                            </div>
                            <div class="modal-body">
                                The shifts that tou want to exchange don't have the same task type.
                                <br />
                                Old shift :
                                <b>
                                    <t
                                        t-esc="exchanged_tmpl_dated.template_id.task_type_id.name"
                                    />
                                </b>
                                <br />
                                New shift :
                                <b>
                                    <t
                                        t-esc="tmpl_dated.template_id.task_type_id.name"
                                    />
                                </b>
                                <br />
                                Do you want to continue ?
                            </div>
                            <div class="modal-footer">
                                <button
                                    type="button"
                                    class="btn btn-danger"
                                    data-dismiss="modal"
                                >Cancel</button>
                                <a
                                    class="btn btn-success"
                                    t-att-href="'/my/shift/swap/subscribe/%i/%s' % (tmpl_dated.template_id,tmpl_dated.date)"
                                >Exchange anyway</a>
                            </div>
                        </div>
                    </div>
                </div>
            </t>
            <p t-if="not all_shifts">
                <a
                    class="btn btn-secondary btn-dark btn-block"
                    href="/my/shift/swap/no_result"
                >
                    No shifts suits me
                </a>
            </p>
        </template>

        <!-- Template for page /my/shift/swap -->
        <template id="website_shift_swap_tmpl_dated" name="Shift Swap Page">
            <t t-call="portal.portal_layout">
                <t t-set="no_breadcrumbs" t-value="True" />
                <div class="container mt16">
                    <div class="row">
                        <div class="col text-center">
                            <t t-call="beesdoo_website_shift_swap.swap_shift_title" />
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12 col-lg-6 m-auto text-justify">
                            <t
                                t-call="beesdoo_website_shift_swap.website_shift_swap_summary"
                            />
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12 col-lg-8">
                            <t
                                t-call="beesdoo_website_shift_swap.website_shift_swap_next_tmpl_dated"
                            />
                        </div>
                        <div class="col-12 col-lg-4 text-justify">
                            <t t-call="beesdoo_website_shift_swap.help_text_title" />
                            <t
                                t-if="not all_shifts"
                                t-call="beesdoo_website_shift_swap.help_text_swap_underpopulated_common"
                            />
                            <t
                                t-else=""
                                t-call="beesdoo_website_shift_swap.help_text_swap_all"
                            />
                        </div>
                    </div>
                </div>
            </t>
        </template>

    </data>
</odoo>
